!function(t){function e(e){for(var o,i,a=e[0],l=e[1],c=e[2],d=0,f=[];d<a.length;d++)i=a[d],s[i]&&f.push(s[i][0]),s[i]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);for(u&&u(e);f.length;)f.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,a=1;a<n.length;a++){var l=n[a];0!==s[l]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},s={5:0},r=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;r.push([14,0]),n()}({14:function(t,e,n){"use strict";n.r(e),function(t){n(2);var e=n(1);t(document).ready(function(){!function(){let n={columns:[],activeObject:null,result:[],routeExport:"/export",key:t("#js-template_keys").html(),exhibition:{name:"exhibition",li:t("#js-template_exhibition").html(),class:".js-column_exhibition"},artwork:{name:"artwork",li:t("#js-template_artwork").html(),class:".js-column_artwork"},park:{name:"park",li:t("#js-template_park").html(),class:".js-column_park"},artist:{name:"artist",li:t("#js-template_artist").html(),class:".js-column_artist"},org:{name:"org",li:t("#js-template_org").html(),class:".js-column_org"}},o={init:function(){s.init()},sendFile:function(e){this.postFile(t(e),t(e).attr("action")).done(function(e){if(console.log(e),0==e.success)console.log("Form Error(s)!"),console.dir(e),o.iterateErrors(e);else if(1==e.success){n.columns=e.data;for(const o of e.data)console.log("COLUMN: "+o),n.key=t(n.key).append(t("<option></option>").attr("value",o).text(o));console.log(n.columns),o.buildUL(),s.toggleVisible(t("#js-import_data")),t("#data_file").remove(),t("#file_file").clone().attr("id","data_file").addClass("d-none").appendTo("#js-import_data_ul")}else console.log("Don't know what to do!"),console.dir(e)})},sendData:function(e){this.postFile(t(e),t(e).attr("action")).done(function(t){if(0==t.success)console.log("Form Error(s)!"),console.dir(t),o.iterateErrors(t);else if(1==t.success){n.result=t,console.log(n.result);let e=n.result.data.reduce((t,e)=>(1==e.success?t.success++:t.error++,e.warning.length>0&&t.warning++,t),{success:0,warning:0,error:0});console.dir(e),s.showModal(`<h3>'\n                ${n.activeObject.name.toUpperCase()} IMPORT RESULTS\n              </h3>\n              <ul>\n                <li>Records imported: ${e.success}</li>\n                <li>Records with warnings: ${e.warning}</li>\n                <li>Records with errors: ${e.error}</li>\n              </ul>`)}else console.log("Don't know what to do!"),console.dir(t)})},sendExport:function(){this.postExport(n.routeExport,n.result.data).done(function(t){console.log("EXPORT DONE!"),console.log(t)})},buildUL:function(){t("#js-data_ul").html(),n.columns.forEach(function(e){t("#js-data_ul").append(`<li \n              class="[ row mb-3 align-items-baseline justify-content-center ]"\n             >\n              <div class="js-key">${t(n.key)[0].outerHTML}</div>\n              <div class="[ px-3 ]">\n                <i class="fas fa-arrow-right c-blue--l"></i>\n              </div>\n              <div class="js-value"></div>\n            </li>`)}),o.appendNameList(".js-column_key")},appendNameList:function(e){t(e).each(function(e){t(this).attr("name",t(this).attr("name")+"-"+(e+1))})},changeObject:function(e){n.activeObject=n[e],console.log(n.activeObject),t(".js-value").each(function(){t(this).html(n.activeObject.li)}),o.appendNameList(n.activeObject.class)},postFile:function(e,n){console.log("Post route: "+n);let o=new FormData(t(e)[0]);return console.log(o),t.ajax({type:"POST",url:n,processData:!1,contentType:!1,data:o})},iterateErrors:function(t){for(const n in t.data)console.log("ERROR ITEM: "+n),e.a.addErrors(n+": "+t.data[n])},postExport:function(e,n){return t.ajax({url:e,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(n)})}},s={init:function(){this.sendFile(),this.sendData(),this.changeObject(),this.sendExport()},sendFile:function(){t("#js-post_file").on("click",function(e){e.preventDefault(),o.sendFile(t("#js-form_import_file"))})},sendData:function(){t("#js-post_data").on("click",function(e){e.preventDefault(),o.sendData(t("#js-form_import_data"))})},changeObject:function(){t("#class_object").change(function(e){let n=s.getVal();n&&(o.changeObject(n),t("#js-data_ul").removeClass("d-none"))})},getVal:function(){return t("#class_object").val()},toggleVisible:function(e){t(e).removeClass("d-none")},showModal:function(e){t("#js-modal_results").modal("show").find("div.modal-body").html(e)},sendExport:function(){t("#js-modal-post_export").on("click",function(t){t.preventDefault(),o.sendExport()})}};o.init()}()})}.call(this,n(2))}});
//# sourceMappingURL=import.bundle.js.map